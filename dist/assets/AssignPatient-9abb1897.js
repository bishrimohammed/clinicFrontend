import{Q as p,f,j as s}from"./index-adc5c439.js";import{u}from"./useQuery-0c7d53ac.js";import{A as l}from"./axiosInstance-8e812653.js";import{A as c}from"./useAxiosHeaders-0302b736.js";import{u as g}from"./useMutation-46d3959e.js";import{u as y}from"./index.esm-28bdf91a.js";import{S as N}from"./index.esm-650f3687.js";import{C as S}from"./InputGroupContext-86e132d6.js";import{d as w,p as A}from"./parseISO-36567b2a.js";import{F as r}from"./Form-fd32e757.js";import{R as C}from"./Row-191556ab.js";import{C as o}from"./Col-cdbc53ce.js";import"./constants-0a94a958.js";import"./ElementChildren-abb33785.js";const _=e=>{const a=c();return console.log(a),u({queryKey:["users",e],queryFn:async()=>l.get(`/user/search?query=${e}`,{...a}).then(d=>d.data),staleTime:5*60*60*1e3})},D=()=>{const e=c();return u({queryKey:["visitType"],queryFn:async()=>l.get("/visittype",{},{...e}).then(a=>a.data),staleTime:60*60*1e3})},G=()=>{const e=c();return g({mutationFn:async a=>(console.log(a),await l.post("/assignpatient",a,{...e})),onSuccess:async a=>{p.success("Assigned succeessfully")},onError:async a=>{p.error(a.response.data.message)}})},k=()=>{const{state:e}=f(),{data:a,error:d,isPending:x}=_("doctor"),{data:i}=D(),{register:t,formState:{errors:v},handleSubmit:h}=y({defaultValues:{assignment_date:new Date().toISOString().substring(0,10)}}),{mutate:j}=G();if(x)return s.jsx(N,{animation:"grow"});const b=n=>{console.log(n);const m={...n,patient_id:e.id};console.log(m),j(m)};return s.jsx(S,{className:"p-3 ",children:s.jsxs("div",{className:"p-3  bg-hrun-box hrunboxshadow",children:[s.jsx("h5",{className:"border-bottom border-1 border-black py-2 mb-3 fw-bold",children:"Assign patient"}),s.jsxs("div",{className:"d-flex gap-md-4 gap-2 flex-wrap mt-md-3 mb-md-2",children:[s.jsxs("span",{children:[s.jsx("span",{className:"fw-bold me-2",children:"Name:"}),`${e.firstName} ${e.middleName}`]}),s.jsxs("span",{children:[s.jsx("span",{className:"fw-bold me-2",children:"Gender:"}),e.gender]}),s.jsxs("span",{children:[s.jsx("span",{className:"fw-bold me-2",children:"card No :"}),e==null?void 0:e.card_number]}),s.jsxs("span",{children:[s.jsx("span",{className:"fw-bold me-2",children:"Age:"}),w(new Date,A(e.birth_date))," years"]})]}),s.jsx("div",{className:"mt-4",children:s.jsxs(r,{onSubmit:h(b),children:[s.jsxs(C,{children:[s.jsx(o,{md:4,sm:12,children:s.jsxs(r.Group,{className:"mb-3",children:[s.jsx(r.Label,{children:"Select Doctor"}),s.jsx(r.Control,{as:"select",...t("doctor_id"),children:a.map(n=>s.jsxs("option",{value:n.id,children:["Dr. ",n.firstName," ",n.lastName]},n.id))})]})}),s.jsx(o,{md:4,sm:12,children:s.jsxs(r.Group,{className:"mb-3",children:[s.jsx(r.Label,{children:"Select Visit Type"}),s.jsx(r.Control,{as:"select",defaultValue:"default",...t("visit_type_id"),children:i==null?void 0:i.map(n=>s.jsx("option",{value:n.id,children:n.name},n.id))})]})}),s.jsx(o,{md:4,sm:12,children:s.jsxs(r.Group,{className:"mb-3",children:[s.jsx(r.Label,{children:"Reason"}),s.jsx(r.Control,{type:"text",placeholder:"reason..",...t("reason")})]})}),s.jsx(o,{md:4,sm:12,children:s.jsxs(r.Group,{className:"mb-3",children:[s.jsx(r.Label,{children:"Visit Date"}),s.jsx(r.Control,{type:"date",min:new Date().toISOString().substring(0,10),placeholder:"date..",...t("assignment_date")})]})})]}),s.jsx("div",{className:"d-flex justify-content-end",children:s.jsx("button",{className:"btn btn-primary px-5",type:"submit",children:"+ Assign"})})]})})]})})};export{k as default};
