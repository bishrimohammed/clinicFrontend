import{l as x,Q as d,m as h,r as p,j as s}from"./index-adc5c439.js";import{f as g,a as j}from"./formatDate-f5528b17.js";import{u as f}from"./useQuery-0c7d53ac.js";import{A as l}from"./axiosInstance-8e812653.js";import{u as y}from"./useMutation-46d3959e.js";import{A as b}from"./useAxiosHeaders-0302b736.js";import{T as R}from"./Table-892073ec.js";import{F as n}from"./Form-fd32e757.js";import{b as A}from"./InputGroupContext-86e132d6.js";import{S as q}from"./index.esm-650f3687.js";import"./moment-fbc5633a.js";import"./ElementChildren-abb33785.js";import"./Col-cdbc53ce.js";function v(t){return f({queryKey:["MedicalHistory","imaging studies",t],queryFn:async()=>l.get(`/lab/orderedImageStudies/${t}`).then(e=>e.data),staleTime:5*60*1e3})}const I=()=>{const t=x(),e=b();return y({mutationFn:async({Data:r,testId:i})=>l.post(`lab/${i}/addimagingresult`,r,{...e}),onSuccess:async r=>{const{data:i}=r;d.success("investigations successfully submited"),t.invalidateQueries({queryKey:["MedicalHistory","imaging studies",i.medicalId],exact:!0})},onError:r=>{d.error(r.response.data.message)}})},G=()=>{const{historyId:t}=h(),{data:e}=v(t),{mutateAsync:r,isPending:i}=I(),a=p.useRef(),c=o=>{o.preventDefault();const u={imageResult:a.current.value};r({Data:u,testId:e._id})};return s.jsxs(s.Fragment,{children:[s.jsx("h3",{children:"Add Imaging Results"}),s.jsxs("div",{className:"p-2 boxshadow mb-2",children:[s.jsx("h6",{children:"clinical finding"}),s.jsx("p",{children:e==null?void 0:e.clinical_finding})]}),s.jsxs(R,{striped:!0,bordered:!0,children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Date Requested"}),s.jsx("th",{children:"Test Name"}),s.jsx("th",{children:"Requested By"}),s.jsx("th",{children:"status"})]})}),s.jsxs("tbody",{children:[e==null?void 0:e.investigations.map((o,m)=>s.jsxs("tr",{children:[s.jsxs("td",{children:[g(e==null?void 0:e.orderTime)," ",j(e==null?void 0:e.orderTime)]}),s.jsx("td",{children:o.test_name}),s.jsx("td",{children:e==null?void 0:e.requestBy.username}),s.jsx("td",{children:e==null?void 0:e.status})]},m)),s.jsx("tr",{})]})]}),s.jsx("div",{className:"my-3 p-2 boxshadow",children:s.jsxs(n,{onSubmit:c,children:[s.jsxs(n.Group,{className:"mb-3 p-2",children:[s.jsx(n.Label,{className:"text-nowrap fw-bold",children:"Write Report :"}),s.jsx(n.Control,{style:{minHeight:150},className:"border border-2",as:"textarea",ref:a,name:"complaint",defaultValue:e==null?void 0:e.imageResult,required:!0,placeholder:"Enter...",disabled:(e==null?void 0:e.status)!=="pending"})]}),s.jsxs(A,{disabled:(e==null?void 0:e.status)!=="pending"||i,className:"ms-3 px-5",variant:"success",type:"submit",children:[i&&s.jsx(q,{animation:"border",size:"sm"}),"+ SAVE"]})]})})]})};export{G as default};
