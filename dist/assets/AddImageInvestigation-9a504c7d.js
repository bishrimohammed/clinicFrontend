import{l as F,Q as u,r as l,m as k,f as R,j as e}from"./index-adc5c439.js";import{A as L}from"./axiosInstance-8e812653.js";import{u as E,F as q,R as G}from"./useGetClinicService-57a25e05.js";import{u as H}from"./useMutation-46d3959e.js";import{A as M}from"./useAxiosHeaders-0302b736.js";import{F as d}from"./Form-fd32e757.js";import{R as Q}from"./Row-191556ab.js";import{C as v}from"./Col-cdbc53ce.js";import{L as m}from"./ListGroup-c3e6cb13.js";import{b as _}from"./InputGroupContext-86e132d6.js";import{S as z}from"./index.esm-650f3687.js";import"./useQuery-0c7d53ac.js";import"./ElementChildren-abb33785.js";import"./DefaultLayout-65fbaa93.js";import"./index.es-ffb0b0ea.js";import"./Nav-d46f6c14.js";const B=()=>{const o=F(),p=M();return H({mutationFn:async i=>L.post("/lab/orderImageinvestigation",i,{...p}),onSuccess:async(i,x)=>{const{data:t}=i;o.invalidateQueries({queryKey:["MedicalHistory",t.medicalId,"Ordered Imageing for history"],exact:!0}),u.success("investigations successfully submitted")},onError:i=>{console.log("on error"),console.log(i),u.error(i.response.data.message)}})},te=()=>{var g,j;const{data:o,error:p}=E("imag"),i=l.useRef(),{historyId:x}=k(),[t,c]=l.useState([]),n=l.useMemo(()=>o&&o.serviceCategory),[f,N]=l.useState(n&&((g=n[0])==null?void 0:g.id)),{state:y}=R(),{mutateAsync:b,isPending:h}=B(),I=s=>{const r=t.findIndex(a=>a===s.id);c(r===-1?[...t,s.id]:t.filter(a=>a!==s.id))};function C(s){for(let r=0;r<n.length;r++){const a=n[r].serviceItem.find(A=>A.id===s);if(a)return a.service_name}return null}const S=s=>{c(t.filter(r=>r!==s))},w=()=>{if(i.current.value===""){u.error(" clinical finding empty");return}const s={historyId:x,investigations:t,clinical_finding:i.current.value,patientId:y.patientId};b(s).then(r=>{r.status===201&&(c([]),i.current.value="")})},T=(j=n==null?void 0:n.filter(s=>s.id===f)[0])==null?void 0:j.serviceItem.map((s,r)=>e.jsxs("button",{style:{cursor:(t.includes(s.id),"pointer")},className:"bg-gredient  border-0  py-2 px-2 d-flex justify-content-center align-items-center ",onClick:()=>I(s),children:[t.includes(s.id)&&e.jsx(q,{color:"green"})," ",s.service_name]},r));return e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"ps-2 bluewhite-bg py-1",children:"order Imaging Investigation"}),e.jsx(d,{className:"d-flex flex-column m-2",children:e.jsxs(d.Group,{children:[e.jsx(d.Label,{children:"Clinical Findings"}),e.jsx(d.Control,{ref:i,as:"textarea",required:!0,placeholder:"Enter text here",className:"border-2 w-75"})]})}),e.jsx("hr",{className:"mt-0"}),e.jsxs(Q,{className:"py-2",children:[e.jsx(v,{sm:7,md:9,className:"pe-0",children:e.jsxs("div",{className:"",children:[e.jsx("h6",{children:"Tests : "}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:T}),e.jsx("div",{className:"d-flex justify-content-between  gap-2 py-2 mt-2",children:e.jsxs("div",{style:{width:"70%"},className:"border border-2 px-2 py-3 ms-2",children:[e.jsx("h6",{children:"Selected Tests : "}),e.jsx("div",{className:"d-flex  flex-wrap gap-2",children:t.map((s,r)=>e.jsxs(m.Item,{as:"li",className:" d-flex gap-1 align-items-center p-1 ",children:[C(s),e.jsx(G,{onClick:()=>S(s),color:"red",size:20,className:"curserpointer"})]},r))})]})})]})}),e.jsx(v,{sm:5,md:3,className:"ps-0",children:e.jsx(m,{as:"ul",className:"boxshadow",children:n==null?void 0:n.map(s=>e.jsx(m.Item,{onClick:()=>N(s.id),active:s.id===f,as:"li",className:"curserpointer ",children:s.name},s.id))})})]}),e.jsx("div",{className:"mt-2 mb-1",children:e.jsxs(_,{className:"border-0 w-100",onClick:w,disabled:t.length===0||h,children:[h&&e.jsx(z,{animation:"border",size:"sm"}),"Submit Tests"]})})]})};export{te as default};
