import{d as ne,l as ie,r as le,j as e}from"./index-adc5c439.js";import{u as te}from"./index.esm-28bdf91a.js";import{c as _,a as o,e as oe,f as K,g as de,h as Q,d as ce,o as me}from"./yup-e734d6e3.js";import{u as he}from"./useMutation-46d3959e.js";import{A as ue}from"./axiosInstance-8e812653.js";import{u as be}from"./useGetWoredas-79e3b962.js";import{C as pe,b as xe}from"./InputGroupContext-86e132d6.js";import{F as s}from"./Form-fd32e757.js";import{R as p}from"./Row-191556ab.js";import{C as l}from"./Col-cdbc53ce.js";import{I as _e}from"./DefaultLayout-65fbaa93.js";import{S as je}from"./index.esm-650f3687.js";import"./useQuery-0c7d53ac.js";import"./ElementChildren-abb33785.js";import"./index.es-ffb0b0ea.js";const ge=()=>{const d=ne(),c=ie();return he({mutationFn:async m=>ue.post("/clinicprofile",m).then(h=>h.data),mutationKey:"addClinicInfo",onSuccess:async()=>{c.invalidateQueries({queryKey:["Clinic Information"],exact:!0}),d(-1)},onError:async m=>{console.log("error"),console.log(m.response.data.message)}})},fe=_().shape({name:o().required("Name is required"),logo:oe().required("Please select an image file"),card_valid_date:K().transform((d,c)=>{if(c!=="")return d}).transform(d=>Math.abs(d)).positive().required("Card is valid date is required"),website_url:o().matches(/((https?):\/\/)?(www.)?[a-z0-9]+(\.[a-z]{2,}){1,3}(#?\/?[a-zA-Z0-9#]+)*\/?(\?[a-zA-Z0-9-_]+=[a-zA-Z0-9-%]+&?)?$/,"Invalid url!"),has_triage:de(),address:_().shape({street:o().required("street is required"),woreda_id:o().required("woreda is required"),house_number:o(),email:o().email("Invalid email"),phone_1:o().matches(/^(09|07)\d{8}$/,"Phone number is invalid").required("Phone number is required"),phone_2:o().nullable()}),motto:o(),clinicType:o(),number_of_branch:K().transform((d,c)=>{if(c!=="")return d}).transform(d=>Math.abs(d)).nullable().typeError("Number of branches must be a number").min(1,"Number of branches must be greater than or equal to 1").required("Number of branches is required"),branch_list:Q(),brand_color:o(),clinc_working_hours:Q().of(_().shape({time_format:o(),day_of_week:o(),start_time:o().matches(ce("time_format")===12?/^(0?[1-9]|1[0-2]):[0-5][0-9] (AM|PM)$/i:/^(0?[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/,"Invalid time").required("Start time is required"),end_time:o().test("valid-time","Invalid start time",d=>{const c=/^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/,m=/^(0[1-9]|1[0-2]):[0-5][0-9] (AM|PM)$/i;return c.test(d)||m.test(d)})}))}),Pe=()=>{var f,y,v,N,w,C,I,k,G,L,S,$,T,q,A,F,M,P,E,V,W,z;const[d,c]=le.useState(null),{mutate:m,isPending:h}=ge(),{data:x}=be(),{register:n,handleSubmit:U,getValues:X,control:ye,watch:j,formState:{errors:r}}=te({defaultValues:{name:"",logo:"",card_valid_date:"",website_url:"",address:{street:"",woreda_id:"",house_number:"",email:"",phone_1:"",phone_2:""},motto:"",clinicType:"",number_of_branch:1,branch_list:[],clinc_working_hours:[],time_format:12},resolver:me(fe)}),Y=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];console.log(r);const ee=async a=>{const t=a.branch_list.map((u,b)=>`address of brach ${b+2} : ${u}
`).join(","),i=new FormData;i.append("name",a.name),i.append("logo",a.logo[0]),i.append("card_valid_date",a.card_valid_date),i.append("website_url",a.website_url),i.append("address",JSON.stringify(a.address)),i.append("motto",a.motto),i.append("clinicType",a.clinicType),i.append("number_of_branch",a.number_of_branch),i.append("branch_address",t),i.append("brand_color",a.brand_color),i.append("has_triage",a.has_triage),i.append("clinc_working_hours",JSON.stringify(a.clinc_working_hours)),m(i)},se=j("number_of_branch"),re=j("time_format");console.log(typeof re);function ae(a){return Array(Math.abs(a)).fill(a)}const g=ae(Number(se));return e.jsx(pe,{className:"p-3  mb-5",children:e.jsx("div",{className:" bg-hrun-box hrunboxshadow",children:e.jsxs(s,{onSubmit:U(ee),encType:"multipart/form-data",children:[e.jsx("h6",{className:"border-bottom border-1 border-black py-2 mb-3 fw-bold",children:"Basic Information"}),e.jsxs(p,{children:[e.jsxs(l,{md:4,sm:12,className:"mb-2",children:[" ",e.jsxs(s.Group,{controlId:"name",children:[e.jsx(s.Label,{children:"Clinic Name"}),e.jsx(s.Control,{type:"text",...n("name"),isInvalid:r.name}),e.jsx(s.Control.Feedback,{type:"invalid",className:"text-small",children:(f=r.name)==null?void 0:f.message})]})]}),e.jsx(l,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{children:"Logo"}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between gap-4 p-1",children:[e.jsx(s.Control,{type:"file",className:"border-1",accept:"image/png, image/jpeg",id:"logo",name:"logo",...n("logo",{onChange:a=>c(URL.createObjectURL(a.target.files[0]))}),isInvalid:r.logo}),e.jsx(s.Control.Feedback,{type:"invalid",className:"text-small",children:(y=r.logo)==null?void 0:y.message}),e.jsx("div",{children:((v=X("logo"))==null?void 0:v.length)===1&&e.jsx(_e,{src:d,width:30,height:10,fluid:!0})})]})]})}),e.jsx(l,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{controlId:"website",children:[e.jsx(s.Label,{children:"Clinic Type"}),e.jsxs(s.Select,{...n("clinicType"),isInvalid:r.clinicType,children:[e.jsx("option",{value:"",children:"select type"}),e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"eye",children:"Eye"}),e.jsx("option",{value:"medium",children:"Medium"})]}),e.jsx(s.Text,{className:"text-danger",children:(N=r.clinicType)==null?void 0:N.message})]})}),e.jsx(l,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{controlId:"website",children:[e.jsx(s.Label,{children:"Website"}),e.jsx(s.Control,{type:"text",...n("website_url"),isInvalid:r.website_url}),r.website_url&&e.jsx(s.Text,{className:"text-danger",children:(w=r.website_url)==null?void 0:w.message})]})}),e.jsx(l,{md:2,sm:6,className:"mb-2",children:e.jsxs(s.Group,{controlId:"website",children:[e.jsx(s.Label,{children:"Brand Color"}),e.jsx(s.Control,{type:"color",className:"w-100",...n("brand_color"),isInvalid:r.website_url,defaultValue:"#000000"}),e.jsx(s.Text,{className:"text-danger",children:(C=r.brand_color)==null?void 0:C.message})]})}),e.jsx(l,{md:2,sm:6,className:"mb-2",children:e.jsxs(s.Group,{controlId:"website",children:[e.jsx(s.Label,{children:"has trainge"}),e.jsx(s.Check,{type:"checkbox",className:"w-100",...n("has_triage"),isInvalid:r.has_triage}),e.jsx(s.Text,{className:"text-danger",children:(I=r.brand_color)==null?void 0:I.message})]})}),e.jsx(l,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{controlId:"website",children:[e.jsx(s.Label,{children:"Motto"}),e.jsx(s.Control,{type:"text",className:"w-100",...n("motto"),isInvalid:r.motto}),e.jsx(s.Text,{className:"text-danger",children:(k=r.motto)==null?void 0:k.message})]})}),e.jsx(l,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{controlId:"phone",children:[e.jsx(s.Label,{children:"card_valid_date"}),e.jsx(s.Control,{type:"number",...n("card_valid_date"),isInvalid:r.card_valid_date}),r.card_valid_date&&e.jsx(s.Text,{className:"text-danger",children:(G=r.card_valid_date)==null?void 0:G.message})]})}),e.jsx(l,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{children:"Number of Brach"}),e.jsx(s.Control,{type:"number",className:"w-100",...n("number_of_branch"),isInvalid:r.number_of_branch,min:"1"}),e.jsx(s.Text,{className:"text-danger",children:(L=r.number_of_branch)==null?void 0:L.message})]})}),g.length>1&&g.splice(1).map((a,t)=>e.jsx(l,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{children:[e.jsxs(s.Label,{children:["branch ",t+2," address"]}),e.jsx(s.Control,{type:"text",className:"w-100",...n(`branch_list.${t}`)},a.id)]})},t))]}),e.jsx("h6",{className:"border-bottom border-1 border-black py-2 mb-3 fw-bold",children:"Address Information"}),e.jsxs(p,{children:[e.jsxs(l,{md:4,sm:12,className:"mb-2",children:[e.jsxs(s.Group,{children:[e.jsx(s.Label,{children:"Phone"}),e.jsx(s.Control,{type:"number",placeholder:"09/07********",...n("address.phone_1"),isInvalid:(S=r.address)==null?void 0:S.phone_1})]}),e.jsx(s.Control.Feedback,{type:"inValid",className:"small text-danger",children:(T=($=r==null?void 0:r.address)==null?void 0:$.phone_1)==null?void 0:T.message})]}),e.jsx(l,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{children:"Email"}),e.jsx(s.Control,{type:"email",...n("address.email",{}),placeholder:"example@example.com",isInvalid:(q=r.address)==null?void 0:q.email}),e.jsx(s.Control.Feedback,{type:"inValid",className:"small text-danger",children:(F=(A=r==null?void 0:r.address)==null?void 0:A.email)==null?void 0:F.message})]})}),e.jsx(l,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{children:"Woreda"}),e.jsxs(s.Select,{...n("address.woreda_id"),isInvalid:(M=r.address)==null?void 0:M.woreda_id,children:[e.jsx("option",{value:"",children:"Select Woreda"}),x==null?void 0:x.map((a,t)=>{var i;return e.jsxs("option",{value:a.id,children:[a.name," ",(i=a.SubCity)==null?void 0:i.Subcity_name]},t)})]})]})}),e.jsx(l,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{children:"Street Address"}),e.jsx(s.Control,{type:"text",...n("address.street"),isInvalid:(P=r.address)==null?void 0:P.street})]})}),e.jsx(l,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{children:"House Number"}),e.jsx(s.Control,{type:"number",...n("address.house_number"),isInvalid:(E=r.address)==null?void 0:E.house_number})]})}),e.jsx(l,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{children:"Alternative Phone"}),e.jsx(s.Control,{type:"number",...n("address.phone_2",{pattern:{value:/^(09|07)?\d{8}$/,message:"phone number is invalid"}}),placeholder:"09/07********",isInvalid:(V=r.address)==null?void 0:V.phone_2}),e.jsx(s.Control.Feedback,{type:"inValid",className:"small tetx-danger",children:(z=(W=r==null?void 0:r.address)==null?void 0:W.phone_2)==null?void 0:z.message})]})})]}),e.jsx("h6",{className:"border-bottom border-1 border-black py-2 mb-3 fw-bold",children:"Clinic Working Hour"}),e.jsx(p,{children:Y.map((a,t)=>{var i,u,b,B,R,H,O,D,Z,J;return e.jsxs(l,{md:6,sm:12,className:"mb-2",children:[e.jsx(s.Label,{className:"fw-bold",children:a}),e.jsxs(p,{children:[e.jsx("input",{type:"text",hidden:!0,...n(`clinc_working_hours[${t}].date_of_week`),value:a}),e.jsxs(l,{children:[e.jsx(s.Group,{children:e.jsx(s.Control,{type:"text",...n(`clinc_working_hours[${t}].start_time`,{}),isInvalid:(u=(i=r==null?void 0:r.clinc_working_hours)==null?void 0:i[t])==null?void 0:u.start_time,placeholder:"start time"})}),e.jsx(s.Control.Feedback,{type:"invalid",children:(R=(B=(b=r==null?void 0:r.clinc_working_hours)==null?void 0:b[t])==null?void 0:B.start_time)==null?void 0:R.message})]}),e.jsxs(l,{children:[e.jsx(s.Group,{children:e.jsx(s.Control,{type:"text",...n(`clinc_working_hours[${t}].end_time`),isInvalid:(O=(H=r==null?void 0:r.clinc_working_hours)==null?void 0:H[t])==null?void 0:O.end_time,placeholder:"end time"})}),e.jsx(s.Control.Feedback,{type:"invalid",children:(J=(Z=(D=r==null?void 0:r.clinc_working_hours)==null?void 0:D[t])==null?void 0:Z.end_time)==null?void 0:J.message})]})]})]},t)})}),e.jsxs(xe,{disabled:h,type:"submit",children:[h&&e.jsx(je,{animation:"border",size:"sm"})," ",e.jsx("span",{className:"fw-bold fs-lg",children:"+"})," SAVE"]})]})})})};export{Pe as default};
