import{j as e,r as u,R as g,u as f,L as p,N as l}from"./index-adc5c439.js";import{T as b}from"./Table-892073ec.js";import{u as y}from"./useQuery-0c7d53ac.js";import{A as N}from"./axiosInstance-8e812653.js";import{B as M,a as x}from"./index.esm-ed00e8fc.js";import{b as v,C as S}from"./InputGroupContext-86e132d6.js";import{S as D}from"./index.esm-650f3687.js";import{c as h,d as _,p as j}from"./parseISO-36567b2a.js";import{t as o}from"./constants-0a94a958.js";function w(r,t){const s=o(r),a=o(t),i=s.getFullYear()-a.getFullYear(),c=s.getMonth()-a.getMonth();return i*12+c}function F(r){const t=o(r);return t.setHours(23,59,59,999),t}function L(r){const t=o(r),s=t.getMonth();return t.setFullYear(t.getFullYear(),s+1,0),t.setHours(23,59,59,999),t}function R(r){const t=o(r);return+F(t)==+L(t)}function A(r,t){const s=o(r),a=o(t),i=h(s,a),c=Math.abs(w(s,a));let n;if(c<1)n=0;else{s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-i*c);let d=h(s,a)===-i;R(o(r))&&c===1&&h(r,a)===1&&(d=!1),n=i*(c-Number(d))}return n===0?0:n}const E=({searchvalue:r,setSearch:t})=>e.jsx("div",{className:"mb-3 me-2  d-flex align-items-center justify-content-end",children:e.jsxs("div",{className:"search border border-2 border-color borderRadius7px",children:[e.jsx("input",{placeholder:"Search...",type:"search",defaultValue:"",onChange:s=>t(s.target.value),className:"border-0 p-2"}),e.jsx(v,{className:"border-0 py-2 px-3 bg-white text-dark",id:"button-addon2",children:e.jsx(M,{size:20,color:"dark"})})]})}),P=r=>{const t=r||"";return y({queryKey:["searchPatient",t],queryFn:async()=>N.get(`/patient/search?query=${t}`).then(s=>s.data),staleTime:20*60*1e3})},Y=(r,t)=>{const[s,a]=u.useState(r);return u.useEffect(()=>{const i=setTimeout(()=>{a(r)},t);return()=>{clearTimeout(i)}},[r,t]),s},$=({searchValue:r})=>{const t=f(n=>n.auth.user),{data:s,isLoading:a,isError:i,error:c}=P(r);return a?e.jsx(D,{animation:"grow"}):i?e.jsxs("div",{children:["error ",c.message]}):(console.log(s),e.jsx(e.Fragment,{children:e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"bg-primary my-2"})," ",e.jsxs(b,{striped:!0,bordered:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Full Name"}),e.jsx("th",{children:"sex"}),e.jsx("th",{children:"status"}),e.jsx("th",{children:"Age"}),e.jsx("th",{children:"phone"}),e.jsx("th",{children:"card no"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:s.length!==0?s.map((n,d)=>{var m;return e.jsxs("tr",{children:[e.jsx("td",{children:d+1}),e.jsx("td",{children:`${n.firstName} ${n.middleName}`}),e.jsx("td",{children:n.gender}),e.jsx("td",{children:n.status?"active":"inactive"}),e.jsxs("td",{children:[_(new Date,j(n.birth_date)),"Y/",A(new Date,j(n.birth_date))%12,"M"]}),e.jsx("td",{children:(m=n.address)==null?void 0:m.phone_1}),e.jsx("td",{children:n.card_number}),t.role.name==="cashier"&&e.jsx("td",{children:e.jsx(l,{to:`/patients/editpatient/${n.id}`,state:n,children:e.jsx(x,{size:20})})}),t.role.name==="cashier"&&e.jsx("td",{children:e.jsxs(l,{to:`/patients/assign/${n.id}`,state:n,children:[e.jsx(x,{size:20}),"assign"]})}),t.role==="doctor"&&e.jsx("td",{children:e.jsx(l,{to:`/patients/view/${n.id}`,children:"view"})})]},d)}):e.jsx("tr",{children:e.jsx("td",{children:"no patient"})})})]})]})}))},I=g.memo($),U=()=>{const r=f(i=>i.auth.user),[t,s]=u.useState(""),a=Y(t,500);return e.jsx(e.Fragment,{children:e.jsx(S,{className:"p-3",children:e.jsxs("div",{className:"p-3 bg-hrun-box",children:[e.jsxs("div",{className:" d-flex justify-content-between align-items-center w-100 mb-1",children:[e.jsx("h4",{className:"d-flex justify-content-center align-items-center mb-0",children:"Patients List"}),r.role==="cashier"&&e.jsx(p,{to:"/patients/newpatient",className:"btn btn-primary",children:"Add Patient"})]}),e.jsx("hr",{}),e.jsx(E,{searchvalue:t,setSearch:s}),e.jsx(I,{searchValue:a})]})})})};export{U as default};
