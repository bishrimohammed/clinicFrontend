import{m as b,c as N,d as C,f as $,u as w,l as I,r as d,e as m,j as e,O as H,Q as p}from"./index-adc5c439.js";import"./DefaultLayout-65fbaa93.js";import{u as k}from"./useMedicalhistory-d492c1f3.js";import{u as S}from"./useMutation-46d3959e.js";import{A as E}from"./axiosInstance-8e812653.js";import{A as M}from"./useAxiosHeaders-0302b736.js";import{S as h}from"./index.esm-650f3687.js";import{L as a}from"./ListGroup-c3e6cb13.js";import{C as A}from"./InputGroupContext-86e132d6.js";import{d as D,p as O}from"./parseISO-36567b2a.js";import"./index.es-ffb0b0ea.js";import"./useQuery-0c7d53ac.js";import"./Nav-d46f6c14.js";import"./constants-0a94a958.js";const X=()=>{const{historyId:s}=b(),c=N(),{data:t,isPending:u,error:x,isError:y}=k(s),r=C(),o=$(),n=w(i=>i.auth.user),v=I();let j=M();const f=S({mutationFn:async i=>E.put(`/patienthistory/${i}/closehistory`,{},{...j}),onSuccess:async(i,l)=>{p.success("The history has been successfully closed"),v.invalidateQueries({queryKey:["MedicalHistory",l],exact:!0})},onError:i=>{var l;p.error((l=i==null?void 0:i.response)==null?void 0:l.data.message),console.log(i)}});if(d.useEffect(()=>(c(m(!1)),()=>{c(m(!0))}),[c]),u)return e.jsx(h,{animation:"grow",variant:"primary"});if(y)return e.jsxs("div",{children:["error : ",x.message]});const g=()=>{f.mutate(s)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"w-100 h-100 d-flex",style:{position:"relative"},children:[e.jsxs("div",{style:{width:"16rem",backgroundColor:"white"},className:"mb-4 pt-2 mt-2 d-flex flex-column  patientDetailsidebarContainer",children:[e.jsx("div",{className:" ps-3 d-flex flex-column",children:e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"mr-1",children:"Name:"})," ",t==null?void 0:t.patient.firstName," ",t==null?void 0:t.patient.middleName]}),e.jsxs("div",{children:[e.jsx("span",{className:"mr-1",children:"Age:"})," ",D(new Date,O(t==null?void 0:t.patient.birth_date))," ","years"]}),e.jsxs("div",{children:[e.jsx("span",{className:"mr-1",children:"MRN:"})," ",t.patient.card_number]}),e.jsxs("div",{children:[e.jsx("span",{className:"mr-1",children:"Sex:"})," ",t==null?void 0:t.patient.gender]})]})}),e.jsx("hr",{className:"mb-0"}),e.jsx("div",{style:{height:"100%"},className:"patientDetailsidebar  flex-grow-1 ",children:e.jsx("div",{className:"pt-0",children:e.jsxs(a,{as:"ul",children:[n.role.name==="doctor"&&e.jsxs(e.Fragment,{children:[e.jsx(a.Item,{to:`/patients/history/${s}`,onClick:()=>r(`/patients/history/${s}`),style:{cursor:"pointer"},active:o.pathname.split("/").length===4,children:"History Overview"}),e.jsx(a.Item,{to:`/patients/history/${s}`,onClick:()=>r(`/patients/history/${s}/note`),style:{cursor:"pointer"},active:o.pathname.endsWith("note"),children:"Patient Note"})]}),(n.role.name==="doctor"||n.role.name==="cashier"||n.role.name==="laboratorian")&&e.jsx(a.Item,{to:`/patients/history/${s}`,onClick:()=>r(`/patients/history/${s}/investigation`),style:{cursor:"pointer"},active:o.pathname.includes("investigation"),children:"investigation"}),n.role.name==="doctor"&&e.jsx(a.Item,{to:`/patients/history/${s}`,onClick:()=>r(`/patients/history/${s}/medication`),style:{cursor:"pointer"},active:o.pathname.endsWith("medication"),children:"Medication"}),n.role.name==="doctor"&&e.jsx(a.Item,{to:`/patients/history/${s}`,onClick:()=>r(`/patients/history/${s}/vital`),style:{cursor:"pointer"},active:o.pathname.endsWith("vital"),children:"Vital Signs"}),e.jsx(a.Item,{to:`/patients/history/${s}`,onClick:()=>r(`/patients/history/${s}/billdetail`),style:{cursor:"pointer"},active:o.pathname.endsWith("billdetail"),children:"Bill Info"}),e.jsx(a.Item,{to:`/patients/history/${s}`,onClick:()=>r(`/patients/view/${t==null?void 0:t.patientId._id}`),style:{cursor:"pointer"},children:"Patient OverView"}),n.role.name==="doctor"&&e.jsx("div",{onClick:g,style:{pointerEvents:t.status?"initial":"none",cursor:t.status?"pointer":"no-drop"},className:`px-3 py-2 curserpointer closehistorybutton ${t.status?"":"border-start border-start-1 border-2 border-danger text-danger"} `,children:t.status?" Close History":"History Closed"})]})})})]}),e.jsx("div",{className:" flex-grow-1 ps-2 minHeight100",style:{overflowX:"hidden",position:"relative",minHeight:"80vh"},children:e.jsx(d.Suspense,{fallback:e.jsx(h,{animation:"border",variant:"primary"}),children:e.jsx(A,{className:"py-2 px-2 mb-5",children:e.jsx("div",{className:"p-2  bg-hrun-box hrunboxshadow",children:e.jsx(H,{})})})})})]})})};export{X as default};
