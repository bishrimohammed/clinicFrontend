import{l as T,Q as f,r as u,m as F,j as e}from"./index-adc5c439.js";import{u as L,F as k,R}from"./useGetClinicService-57a25e05.js";import{u as E}from"./useMutation-46d3959e.js";import{A as q}from"./axiosInstance-8e812653.js";import{A as G}from"./useAxiosHeaders-0302b736.js";import{F as x}from"./Form-fd32e757.js";import{R as H}from"./Row-191556ab.js";import{C as v}from"./Col-cdbc53ce.js";import{L as p}from"./ListGroup-c3e6cb13.js";import{b as M}from"./InputGroupContext-86e132d6.js";import{S as Q}from"./index.esm-650f3687.js";import"./useQuery-0c7d53ac.js";import"./ElementChildren-abb33785.js";import"./DefaultLayout-65fbaa93.js";import"./index.es-ffb0b0ea.js";import"./Nav-d46f6c14.js";const _=()=>{const l=T(),d=G();return E({mutationFn:async i=>q.post(`/medicalrecords/${i==null?void 0:i.historyId}/addInvestigation`,i,d),onSuccess:async(i,n)=>{console.log(n),console.log(n.historyId),l.invalidateQueries({queryKey:["MedicalHistory",n.historyId,"Ordered Lab Investigations"],exact:!0}),f.success("investigations successfully submited")},onError:i=>{var n,a;console.log("on error"),console.log(i),f.error((a=(n=i==null?void 0:i.response)==null?void 0:n.data)==null?void 0:a.message)}})},re=()=>{var j,g;const{data:l,error:d}=L("lab"),{mutateAsync:i,isPending:n}=_(),a=u.useRef(),{historyId:y}=F(),[o,m]=u.useState([]),t=u.useMemo(()=>l&&l.serviceCategory),[h,b]=u.useState(t&&((j=t[0])==null?void 0:j.id));if(d)return"An error has occurred: "+d.message;const N=s=>{const r=o.findIndex(c=>c===s.id);m(r===-1?[...o,s.id]:o.filter(c=>c!==s.id))};function I(s){for(let r=0;r<t.length;r++){const c=t[r].serviceItem.find(A=>A.id===s);if(c)return c.service_name}return null}const C=s=>{m(o.filter(r=>r!==s))},S=()=>{if(a.current.value===""){f.error(" clinical finding empty");return}const s={historyId:y,investigations:o,clinical_finding:a.current.value};i(s).then(r=>{r.status===201&&(m([]),a.current.value="")})},w=(g=t==null?void 0:t.filter(s=>s.id===h)[0])==null?void 0:g.serviceItem.map((s,r)=>e.jsxs("button",{style:{cursor:(o.includes(s.id),"pointer")},className:"bg-gredient width23 border-0  py-2 d-flex justify-content-center align-items-center",onClick:()=>N(s),children:[o.includes(s.id)&&e.jsx(k,{color:"green"})," ",s.service_name]},r));return e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"ps-2 bluewhite-bg py-1",children:"order Lab Investigation"}),e.jsx(x,{className:"d-flex flex-column m-2",children:e.jsxs(x.Group,{children:[e.jsx(x.Label,{children:"Clinical Findings"}),e.jsx(x.Control,{ref:a,as:"textarea",required:!0,placeholder:"Enter text here",className:"border-2 w-75"})]})}),e.jsx("hr",{className:"mt-0"}),e.jsxs(H,{className:"py-2",children:[e.jsx(v,{sm:7,md:9,className:"pe-0",children:e.jsxs("div",{className:"",children:[e.jsx("h6",{children:"Tests : "}),e.jsx("div",{className:"d-flex  flex-wrap gap-2",children:w}),e.jsx("div",{className:"d-flex justify-content-between  gap-2 py-2 mt-2",children:e.jsxs("div",{style:{width:"70%"},className:"border border-2 px-2 py-3 ms-2",children:[e.jsx("h6",{children:"Selected Tests : "}),e.jsx("div",{className:"d-flex  flex-wrap gap-2",children:o.map((s,r)=>e.jsxs(p.Item,{as:"li",className:" d-flex gap-1 align-items-center p-1 ",children:[I(s),e.jsx(R,{onClick:()=>C(s),color:"red",size:20,className:"curserpointer"})]},r))})]})})]})}),e.jsx(v,{sm:5,md:3,className:"ps-0",children:e.jsx(p,{as:"ul",className:"boxshadow",children:t==null?void 0:t.map(s=>e.jsx(p.Item,{onClick:()=>b(s.id),active:s.id===h,as:"li",className:"curserpointer ",children:s.name},s.id))})})]}),e.jsx("div",{className:"d-flex justify-content-end align-self-end mt-2 mb-1",children:e.jsxs(M,{className:"border-0 w-100  ",onClick:S,disabled:o.length===0||n,children:[n&&e.jsx(Q,{animation:"border",size:"sm"}),"Submit Tests"]})})]})};export{re as default};
