import{d as je,l as ge,r as fe,f as ye,j as e}from"./index-adc5c439.js";import{u as we}from"./index.esm-28bdf91a.js";import{c as g,a as o,e as ve,f as x,g as Ne,h as oe,d as Ce,o as Ie}from"./yup-e734d6e3.js";import{u as ke}from"./useGetWoredas-79e3b962.js";import{u as $e}from"./useMutation-46d3959e.js";import{A as Le}from"./axiosInstance-8e812653.js";import{C as Ge,b as Se}from"./InputGroupContext-86e132d6.js";import{F as s}from"./Form-fd32e757.js";import{R as _}from"./Row-191556ab.js";import{C as d}from"./Col-cdbc53ce.js";import{I as ce}from"./DefaultLayout-65fbaa93.js";import{S as Te}from"./index.esm-650f3687.js";import"./useQuery-0c7d53ac.js";import"./ElementChildren-abb33785.js";import"./index.es-ffb0b0ea.js";const qe=()=>{const c=je(),h=ge();return $e({mutationFn:async m=>(console.log(m),await Le.put(`/clinicprofile/${m.id}`,m.formData).then(p=>p.data)),onSuccess:()=>{toast.success("Clinic profile updated successfully"),h.invalidateQueries({queryKey:["Clinic Information"],exact:!0}),c(-1)},onError:m=>{toast.error(m.response.data.message)}})},Ve=g().shape({name:o().required("Name is required"),logo:ve().required("Please select an image file"),card_valid_date:x().positive().required("Card is valid date is required"),website_url:o().matches(/((https?):\/\/)?(www.)?[a-z0-9]+(\.[a-z]{2,}){1,3}(#?\/?[a-zA-Z0-9#]+)*\/?(\?[a-zA-Z0-9-_]+=[a-zA-Z0-9-%]+&?)?$/,"Invalid url!"),has_triage:Ne(),address:g().shape({id:x(),street:o().required("street is required"),woreda_id:o().transform(c=>isNaN(c)?void 0:c).required("woreda is required"),house_number:o(),email:o().email("Invalid email"),phone_1:o().matches(/^(09|07)\d{8}$/,"Phone number is invalid").required("Phone number is required"),phone_2:o().nullable()}),motto:o(),clinicType:o(),number_of_branch:x().transform((c,h)=>{if(h!=="")return c}).transform(c=>Math.abs(c)).nullable().typeError("Number of branches must be a number").min(1,"Number of branches must be greater than or equal to 1").required("Number of branches is required"),branch_list:oe(),brand_color:o(),clinc_working_hours:oe().of(g().shape({id:x(),day_of_week:o(),start_time:o().matches(Ce("time_format")===12?/^(0?[1-9]|1[0-2]):[0-5][0-9] (AM|PM)$/i:/^(0?[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/,"Invalid time").required("Start time is required"),end_time:o().test("valid-time","Invalid start time",c=>{const h=/^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/,m=/^(0[1-9]|1[0-2]):[0-5][0-9] (AM|PM)$/i;return h.test(c)||m.test(c)})}))}),Qe=()=>{var y,w,v,N,C,I,k,$,L,G,S,T,q,V,A,F,P,M,E,z,H,W,B,R,D,O,U,Z,J,Q,K,X,Y,ee,se;const[c,h]=fe.useState(null),{mutate:m,isPending:p}=qe(),{data:j}=ke(),{state:n}=ye(),me=a=>{if(!a)return[];const t=/:\s([^,]+)/g;return(a==null?void 0:a.match(t)).map(u=>u.split(": ")[1])},{register:i,handleSubmit:he,getValues:ue,watch:be,formState:{errors:r}}=we({defaultValues:{name:n.name,logo:n.logo,card_valid_date:n.card_valid_date,website_url:n.website_url,address:{id:(y=n.address)==null?void 0:y.id,woreda_id:(w=n.address)==null?void 0:w.woreda_id,street:(v=n.address)==null?void 0:v.street,house_number:(N=n.address)==null?void 0:N.house_number,email:(C=n.address)==null?void 0:C.email,phone_1:(I=n.address)==null?void 0:I.phone_1,phone_2:(k=n.address)==null?void 0:k.phone_2},has_triage:n.has_triage,motto:n.motto,clinicType:n.clinic_type,number_of_branch:n.number_of_branch,branch_list:me(n.branch_addresses),brand_color:n.brand_color},resolver:Ie(Ve)});console.log(r);const pe=be("number_of_branch");function xe(a){return Array(Math.abs(a)).fill(a)}const f=xe(Number(pe)),_e=async a=>{console.log(a);const t=a.branch_list.map((b,u)=>`address of brach ${u+2} : ${b}
`).join(","),l=new FormData;l.append("name",a.name),l.append("logo",a.logo[0]),l.append("card_valid_date",a.card_valid_date),l.append("website_url",a.website_url),l.append("address",JSON.stringify(a.address)),l.append("motto",a.motto),l.append("clinicType",a.clinicType),l.append("number_of_branch",a.number_of_branch),l.append("branch_address",t),l.append("brand_color",a.brand_color),l.append("has_triage",a.has_triage),l.append("clinc_working_hours",JSON.stringify(a.clinc_working_hours)),console.log(a),m({formData:l,id:n==null?void 0:n.id})};return e.jsx(Ge,{className:"p-3  mb-5",children:e.jsx("div",{className:" bg-hrun-box hrunboxshadow",children:e.jsxs(s,{onSubmit:he(_e),encType:"multipart/form-data",children:[e.jsx("h6",{className:"border-bottom border-1 border-black py-2 mb-3 fw-bold",children:"Basic Information"}),e.jsxs(_,{children:[e.jsxs(d,{md:4,sm:12,className:"mb-2",children:[" ",e.jsxs(s.Group,{controlId:"name",children:[e.jsx(s.Label,{children:"Name"}),e.jsx(s.Control,{type:"text",...i("name"),isInvalid:r.name,defaultValue:n.name}),e.jsx(s.Control.Feedback,{type:"invalid",className:"text-small",children:($=r.name)==null?void 0:$.message})]})]}),e.jsx(d,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{children:"Logo"}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between gap-4 p-1",children:[e.jsx(s.Control,{type:"file",className:"border-1",accept:"image/png, image/jpeg",id:"logo",name:"logo",...i("logo",{onChange:a=>h(URL.createObjectURL(a.target.files[0]))}),isInvalid:r.logo}),e.jsx(s.Control.Feedback,{type:"invalid",className:"text-small",children:(L=r.logo)==null?void 0:L.message}),e.jsx("div",{children:((G=ue("logo"))==null?void 0:G.length)===1?e.jsx(ce,{src:c,width:30,height:10,fluid:!0}):e.jsx(ce,{src:"http://localhost:5000/"+(n==null?void 0:n.logo),width:30,height:10,fluid:!0})})]})]})}),e.jsx(d,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{controlId:"website",children:[e.jsx(s.Label,{children:"Clinic Type"}),e.jsxs(s.Select,{...i("clinicType"),isInvalid:r.clinicType,children:[e.jsx("option",{value:"",children:"select type"}),e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"eye",children:"Eye"}),e.jsx("option",{value:"medium",children:"Medium"})]}),e.jsx(s.Text,{className:"text-danger",children:(S=r.clinicType)==null?void 0:S.message})]})}),e.jsx(d,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{controlId:"website",children:[e.jsx(s.Label,{children:"Website"}),e.jsx(s.Control,{type:"text",...i("website_url"),isInvalid:r.website_url,defaultValue:n.website_url}),r.website_url&&e.jsx(s.Text,{className:"text-danger",children:(T=r.website_url)==null?void 0:T.message})]})}),e.jsx(d,{md:2,sm:6,className:"mb-2",children:e.jsxs(s.Group,{controlId:"website",children:[e.jsx(s.Label,{children:"Brand Color"}),e.jsx(s.Control,{type:"color",className:"w-100",...i("brand_color"),isInvalid:r.website_url,defaultValue:"#000000"}),e.jsx(s.Text,{className:"text-danger",children:(q=r.brand_color)==null?void 0:q.message})]})}),e.jsx(d,{md:2,sm:6,className:"mb-2",children:e.jsxs(s.Group,{controlId:"website",children:[e.jsx(s.Label,{children:"has Traige"}),e.jsx(s.Check,{type:"checkbox",className:"w-100",...i("has_triage"),isInvalid:r.has_triage}),e.jsx(s.Text,{className:"text-danger",children:(V=r.brand_color)==null?void 0:V.message})]})}),e.jsx(d,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{controlId:"website",children:[e.jsx(s.Label,{children:"Motto"}),e.jsx(s.Control,{type:"text",className:"w-100",...i("motto"),isInvalid:r.motto}),e.jsx(s.Text,{className:"text-danger",children:(A=r.motto)==null?void 0:A.message})]})}),e.jsx(d,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{controlId:"phone",children:[e.jsx(s.Label,{children:"Card Valid Date"}),e.jsx(s.Control,{type:"number",...i("card_valid_date"),isInvalid:r.card_valid_date}),r.card_valid_date&&e.jsx(s.Text,{className:"text-danger",children:(F=r.card_valid_date)==null?void 0:F.message})]})}),e.jsx(d,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{children:"Number of Branch"}),e.jsx(s.Control,{type:"number",className:"w-100",...i("number_of_branch"),isInvalid:r.number_of_branch,min:"1",max:"20"}),e.jsx(s.Text,{className:"text-danger",children:(P=r.number_of_branch)==null?void 0:P.message})]})}),f.length>1&&f.splice(1).map((a,t)=>e.jsx(d,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{children:[e.jsxs(s.Label,{children:["address of branch ",t+2]}),e.jsx(s.Control,{type:"text",className:"w-100",...i(`branch_list.${t}`)},a.id)]})},t))]}),e.jsx("h6",{className:"border-bottom border-1 border-black py-2 mb-3 fw-bold",children:"Address Information"}),e.jsxs(_,{children:[e.jsxs(d,{md:4,sm:12,className:"mb-2",children:[e.jsx("input",{type:"hidden",name:"",...i("address.id")}),e.jsxs(s.Group,{children:[e.jsx(s.Label,{children:"Phone"}),e.jsx(s.Control,{type:"number",placeholder:"09/07********",...i("address.phone_1"),isInvalid:(M=r.address)==null?void 0:M.phone_1,defaultValue:(E=n.address)==null?void 0:E.phone_1})]}),e.jsx(s.Control.Feedback,{type:"inValid",className:"small text-danger",children:(H=(z=r==null?void 0:r.address)==null?void 0:z.phone_1)==null?void 0:H.message})]}),e.jsx(d,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{children:"Email"}),e.jsx(s.Control,{type:"email",...i("address.email",{}),placeholder:"example@example.com",isInvalid:(W=r.address)==null?void 0:W.email,defaultValue:(B=n.address)==null?void 0:B.email}),e.jsx(s.Control.Feedback,{type:"inValid",className:"small text-danger",children:(D=(R=r==null?void 0:r.address)==null?void 0:R.email)==null?void 0:D.message})]})}),e.jsx(d,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{children:"Woreda"}),e.jsxs(s.Select,{...i("address.woreda_id"),isInvalid:(O=r.address)==null?void 0:O.woreda_id,defaultValue:(U=n.address)==null?void 0:U.woreda_id,children:[e.jsx("option",{value:"",children:"Select Woreda"}),j==null?void 0:j.map((a,t)=>{var l;return e.jsxs("option",{value:a.id,children:[a.name," ",(l=a.SubCity)==null?void 0:l.Subcity_name]},t)})]})]})}),e.jsx(d,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{children:"Street Address"}),e.jsx(s.Control,{type:"text",...i("address.street"),isInvalid:(Z=r.address)==null?void 0:Z.street,defaultValue:(J=n.address)==null?void 0:J.street})]})}),e.jsx(d,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{children:"House Number"}),e.jsx(s.Control,{type:"number",...i("address.house_number"),isInvalid:(Q=r.address)==null?void 0:Q.house_number,defaultValue:(K=n.address)==null?void 0:K.house_number})]})}),e.jsx(d,{md:4,sm:12,className:"mb-2",children:e.jsxs(s.Group,{children:[e.jsx(s.Label,{children:"Alternative Phone"}),e.jsx(s.Control,{type:"number",...i("address.phone_2",{pattern:{value:/^(09|07)?\d{8}$/,message:"phone number is invalid"}}),placeholder:"09/07********",isInvalid:(X=r.address)==null?void 0:X.phone_2,defaultValue:(Y=n.address)==null?void 0:Y.phone_2}),e.jsx(s.Control.Feedback,{type:"inValid",className:"small tetx-danger",children:(se=(ee=r==null?void 0:r.address)==null?void 0:ee.phone_2)==null?void 0:se.message})]})})]}),e.jsx("h6",{className:"border-bottom border-1 border-black py-2 mt-1 mb-3 fw-bold",children:"Clinic Working Hour"}),e.jsx(_,{children:n.clinicWorkingHours.map((a,t)=>{var l,b,u,re,ae,ne,ie,le,te,de;return e.jsxs(d,{md:6,sm:12,className:"mb-2",children:[e.jsx(s.Label,{className:"fw-bold",children:a.day_of_week}),e.jsxs(_,{children:[e.jsx("input",{type:"text",hidden:!0,...i(`clinc_working_hours[${t}].date_of_week`),value:a.day_of_week}),e.jsx("input",{type:"text",hidden:!0,...i(`clinc_working_hours[${t}].id`),value:a.id}),e.jsxs(d,{children:[e.jsx(s.Group,{children:e.jsx(s.Control,{type:"text",...i(`clinc_working_hours[${t}].start_time`),isInvalid:(b=(l=r==null?void 0:r.clinc_working_hours)==null?void 0:l[t])==null?void 0:b.start_time,defaultValue:a.start_time,placeholder:"start time"})}),e.jsx(s.Control.Feedback,{type:"invalid",children:(ae=(re=(u=r==null?void 0:r.clinc_working_hours)==null?void 0:u[t])==null?void 0:re.start_time)==null?void 0:ae.message})]}),e.jsxs(d,{children:[e.jsx(s.Group,{children:e.jsx(s.Control,{type:"text",...i(`clinc_working_hours[${t}].end_time`),isInvalid:(ie=(ne=r==null?void 0:r.clinc_working_hours)==null?void 0:ne[t])==null?void 0:ie.end_time,defaultValue:a.end_time,placeholder:"end time"})}),e.jsx(s.Control.Feedback,{type:"invalid",children:(de=(te=(le=r==null?void 0:r.clinc_working_hours)==null?void 0:le[t])==null?void 0:te.end_time)==null?void 0:de.message})]})]})]},t)})}),e.jsxs(Se,{variant:"primary",disabled:p,type:"submit",children:[p&&e.jsx(Te,{animation:"border",size:"sm"}),"Submit"]})]})})})};export{Qe as default};
